# 	Dragon stat Calculation
dragon_stat_calculation = {
	export_to_variable = { which = comratvar value = combat_rating }
	export_to_variable = { which = healthvar value = health }
	export_to_variable = { which = sizeforlocvar value = martial }
	export_to_variable = { which = sizevar value = martial }
	export_to_variable = { which = drastrvar value = martial }
	multiply_variable = { which = comratvar which = healthvar }
	divide_variable = { which = comratvar value = 10 }
	change_variable = { which = drastrvar which = comratvar }
}

set_stats_for_dragon_duel_combatant1 = {
	### Sets Dragon A ###
	random_friend = {
		limit = { is_tamed_dragon = yes }
		set_character_flag = is_in_dragon_duel
		dragon_stat_calculation = yes
		save_event_target_as = Dragon_A
		set_character_flag = debug_scoped
		
		set_variable = { which = global_RdrastrvarA which = drastrvar }
	}
	### Calculates Dragon Rider A's Maneuver | combat rating + martial ###
	#export_to_variable = { which = RcomratvarA value = combat_rating who = event_target:combatant_1 }
	#export_to_variable = { which = RmaneuvarA value = martial who = event_target:combatant_1 }
	#change_variable = { which = RmaneuvarA which = RcomratvarA }
		
	### Adds Dragon strength A to Rider A ###
	#export_to_variable = { which = RcomratvarA value = combat_rating who = event_target:Dragon_A }
	#export_to_variable = { which = RhealthvarA value = health who = event_target:Dragon_A }
	#export_to_variable = { which = RsizevarA value = martial who = event_target:Dragon_A }
	#export_to_variable = { which = RdrastrvarA value = martial who = event_target:Dragon_A }
	#multiply_variable = { which = RcomratvarA which = RhealthvarA }
	#divide_variable = { which = RcomratvarA value = 10 }
	#change_variable = { which = RdrastrvarA which = BcomratvarA }
		
	### Calculates final strength of Dragon and Rider A
	#subtract_variable = { which = RdrastrvarB which = RmaneuvarA }
	#set_variable = { which = global_RdrastrvarA which = RdrastrvarA }
}

set_stats_for_dragon_duel_combatant2 = {
	### Sets Dragon B ###
	random_friend = {
		limit = { is_tamed_dragon = yes }
		set_character_flag = is_in_dragon_duel
		dragon_stat_calculation = yes
		save_event_target_as = Dragon_B
		set_character_flag = debug_scoped
		
		set_variable = { which = global_RdrastrvarA which = drastrvar }
	}
	### Calculates Dragon Rider A's Maneuver | combat rating + martial ###
	#export_to_variable = { which = RcomratvarA value = combat_rating who = event_target:combatant_2 }
	#export_to_variable = { which = RmaneuvarA value = martial who = event_target:combatant_2 }
	#change_variable = { which = RmaneuvarA which = RcomratvarA }
		
	### Adds Dragon strength B to Rider B ###
	#export_to_variable = { which = RcomratvarB value = combat_rating who = event_target:Dragon_B }
	#export_to_variable = { which = RhealthvarB value = health who = event_target:Dragon_B }
	#export_to_variable = { which = RsizevarB value = martial who = event_target:Dragon_B }
	#export_to_variable = { which = RdrastrvarB value = martial who = event_target:Dragon_B }
	#multiply_variable = { which = RcomratvarB which = RhealthvarB }
	#divide_variable = { which = RcomratvarB value = 10 }
	#change_variable = { which = RdrastrvarB which = BcomratvarB }
		
	### Calculates final strength of Dragon and Rider B
	#subtract_variable = { which = RdrastrvarB which = RmaneuvarA }
	#set_variable = { which = global_RdrastrvarB which = RdrastrvarB }
}

set_your_dragon = {
	ROOT = {
		any_friend = {
			limit = { is_tamed_dragon = yes }
			save_event_target_as = your_dragon
		}
	}
}

troop_damage_by_dragon = {
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 30 } 
					NOT = { check_variable = { which = drastrvar value < 20 } } 
				}
			}
		}
		troops = -0.02
		morale = -0.15
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 40 } 
					NOT = { check_variable = { which = drastrvar value < 30 } } 
				}
			}
		}
		troops = -0.05
		morale = -0.19
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 50 } 
					NOT = { check_variable = { which = drastrvar value < 40 } } 
				}
			}
		}
		troops = -0.09
		morale = -0.22
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 60 } 
					NOT = { check_variable = { which = drastrvar value < 50 } } 
				}	
			}
		}
		troops = -0.12
		morale = -0.27
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 70 } 
					NOT = { check_variable = { which = drastrvar value < 60 } } 
				}
			}
		}
		troops = -0.16
		morale = -0.31
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 80 } 
					NOT = { check_variable = { which = drastrvar value < 70 } } 
				}
			}
		}
		troops = -0.2
		morale = -0.39
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 90 } 
					NOT = { check_variable = { which = drastrvar value < 80 } } 
				}
			}
		}
		troops = -0.25
		morale = -0.44
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 100 } 
					NOT = { check_variable = { which = drastrvar value < 90 } } 
				}
			}
		}
		troops = -0.3
		morale = -0.50
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 110 } 
					NOT = { check_variable = { which = drastrvar value < 100 } } 
				}
			}
		}
		troops = -0.35
		morale = -0.56
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 120 } 
					NOT = { check_variable = { which = drastrvar value < 110 } } 
				}
			}
		}
		troops = -0.4
		morale = -0.62
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 130 } 
					NOT = { check_variable = { which = drastrvar value < 120 } } 
				}
			}
		}
		troops = -0.45
		morale = -0.68
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 140 } 
					NOT = { check_variable = { which = drastrvar value < 130 } } 
				}
			}
		}
		troops = -0.5
		morale = -0.73
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 150 } 
					NOT = { check_variable = { which = drastrvar value < 140 } } 
				}
			}
		}
		troops = -0.55
		morale = -0.80
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 160 } 
					NOT = { check_variable = { which = drastrvar value < 150 } } 
				}
			}
		}
		troops = -0.65
		morale = -0.92
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 170 } 
					NOT = { check_variable = { which = drastrvar value < 160 } } 
				}
			}
		}
		troops = -0.7
		morale = -0.97
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value <= 180 } 
					NOT = { check_variable = { which = drastrvar value < 170 } } 
				}
			}
		}
		troops = -0.75
		morale = -0.98
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value = 190 } 
					NOT = { check_variable = { which = drastrvar value < 180 } } 
				}
			}
		}
		troops = -0.99
		morale = -0.99
	}
	if = {
		limit = { 
			ROOT = {
				any_friend = {
					#limit = { is_tamed_dragon = yes }
					check_variable = { which = drastrvar value = 190 } 
					NOT = { check_variable = { which = drastrvar value < 180 } } 
				}
			}
		}
		troops = -1
		morale = -1
	}
}