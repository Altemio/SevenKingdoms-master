is_seven_knightly_member_trigger = {
  society_member_of = knighthood_the_seven
}

is_knightly_member_trigger = {
  is_seven_knightly_member_trigger = yes
}

is_following_spreadable_religion_trigger = {
  OR = {
    religion_group = the_seven_group
    religion = rhllor
    religion = valyrian
  }
}

# Governs religions that are resistant to 
is_resistant_religion_trigger = {
  OR = {
    religion = valyrian
    religion = the_seven
    religion = rhllor
    religion = drowned_god
    religion = moonsingers
    trait = zealous
    culture = northmen
    culture = barrowmen
    culture = flint_clansmen
    culture = crannogmen
    culture = hill_clansmen
    culture = crackclawmen
    culture = mountain_clansmen
    culture = sisterman
    culture = craggon
    culture = fairman
    culture = skagosi
  }
}

# Sponsors both a whitelist and a blacklist in case of overlap in region defines.
# Rules can modify what regions are taken into the system, such as Essos.
is_religion_spread_region_allowed_trigger = {
  # Will never spread beyond the wall.
  NOT = {
    location = {
      region = world_the_wall
      region = world_beyond_the_wall
    }
  }
  
  
  #
  OR = {
    # Will spread everywhere if unrestricted, excluding the wall and beyond
    has_game_rule = {
      name = missionary_system
      value = missionary_system_unrestricted
    }
    
    # Will spread within Essos/Valyria if allowed to
    AND = {
      has_game_rule = {
        name = missionary_system
        value = missionary_system_valyria
      }
      location = {
        region = world_essos_nosteps
      }
    }
    
    # Will spread in Westeros.
    location = {
      OR = {
        region = world_westeros_north_south
      }
    }
  }
}

educator_is_combat_trained = {
  educator = {
    OR = {
      trait = dueling_novice
      trait = dueling_adept
      trait = dueling_skilled
      trait = dueling_expert
      trait = dueling_master
      trait = dueling_legend
    }
  }
}

educator_is_not_combat_trained = {
  educator = {
    NOR = {
      trait = dueling_novice
      trait = dueling_adept
      trait = dueling_skilled
      trait = dueling_expert
      trait = dueling_master
      trait = dueling_legend
    }
  }
}

# The following scripted triggers are used to determine if the educator is at the same level as their ward.
# If the educator is untrained, then the educator_is_not_combat_trained = yes can be used.
# However, educator_is_combat_trained = yes can be used to determine if the event is allowed to pass in the first place.

is_educator_and_ward_novice = {
  educator = {
    trait = dueling_novice
  }
  combat_completely_untrained = yes
}

is_educator_and_ward_adept = {
  educator = {
    trait = dueling_adept
  }
  trait = dueling_adept
}

is_educator_and_ward_skilled = {
  educator = {
    trait = dueling_skilled
  }
  trait = dueling_skilled
}

is_educator_and_ward_expert = {
  educator = {
    trait = dueling_expert
  }
  trait = dueling_expert
}

is_educator_and_ward_master = {
  educator = {
    trait = dueling_master
  }
  trait = dueling_master
}

is_educator_and_ward_legend = {
  educator = {
    trait = dueling_legend
  }
  trait = dueling_legend
}

#

# Cultures that produce very good or even legendary fighters on a regular basis
is_culture_swordsmanship_specialised = {
  OR = {
    culture = braavosi
    culture = flint_clansmen
    culture = hill_clansmen
    culture = clansmen
    culture = dusklander
    culture = mountain_clansmen
    culture_group = dornish
    culture_group = free_folk
    culture_group = iron_islander
  }
}

# Cultures that favour swordsmanship, and generally produce good fighters
is_culture_swordsmanship_favoured = {
  OR = {
    culture = valeman
    culture = stormlander
    culture = evenstar
    culture = northmen
    culture = westerlander
    culture = crannogmen
    culture = crackclawmen
    culture = sisterman
    culture = craggon
    culture = muddish
  }
}

#

ward_is_female_allowed = {
  is_female = yes
  OR = {
    is_combat_trained = yes # Has some pre-existing combat training, or a pre-disposition for combat training.
    
    # The Dornish have no qualms with training different genders.
    # Those of the free cities, such as the Braavosi, care only about coin.
    # Followers of the Mother or Boashi will happily teach a daughter.
    educator = { 
      OR = {
        culture_group = essos_group
        culture_group = dornish
        religion = moonsingers
        religion = faceless_men
        religion = the_mother
        religion = boashi
        religion_group = valyrian_group
      }
    }
    educator = {
      liege = {
        primary_title = {
          OR = {
            has_law = status_of_women_1
            has_law = status_of_women_2
            has_law = status_of_women_3
            has_law = status_of_women_4
          }
        }
      }
    }
    has_game_rule = {
      name = gender
      value = all
    }
  }
}

# These traits are for the Ward, or characters who have x or lower skill.
# TODO: Else-if a lot of these functions within the combat training events

is_combat_trained = {
  OR = {
    trait = dueling_novice
    trait = dueling_adept
    trait = dueling_skilled
    trait = dueling_expert
    trait = dueling_master
    trait = dueling_legend
  }
}

is_combat_untrained = {
  NOR = {
    trait = dueling_novice
    trait = dueling_adept
    trait = dueling_skilled
    trait = dueling_expert
    trait = dueling_master
    trait = dueling_legend
  }
}

is_combat_novice = {
  trait = dueling_novice
}

is_combat_adept_or_lower = {
  OR = {
    trait = dueling_novice
    trait = dueling_adept
  }
  NOR = {
    trait = dueling_skilled
    trait = dueling_expert
    trait = dueling_master
    trait = dueling_legend
  }
}

is_combat_skilled_or_lower = {
  OR = {
    trait = dueling_novice
    trait = dueling_adept
    trait = dueling_skilled
  }
  NOR = {
    trait = dueling_expert
    trait = dueling_master
    trait = dueling_legend
  }
}

is_combat_expert_or_lower = {
  OR = {
    trait = dueling_novice
    trait = dueling_adept
    trait = dueling_skilled
    trait = dueling_expert
  }
    
  NOR = {
    trait = dueling_master
    trait = dueling_legend
  }
}

is_combat_master_or_lower = {
  OR = {
    trait = dueling_novice
    trait = dueling_adept
    trait = dueling_skilled
    trait = dueling_expert
    trait = dueling_master
  }
  NOT = {
    trait = dueling_legend
  }
}

is_combat_legend_or_lower = {
  OR = {
    trait = dueling_novice
    trait = dueling_adept
    trait = dueling_skilled
    trait = dueling_expert
    trait = dueling_master
    trait = dueling_legend
  }
}

##

is_victorious_opponent_dead = {
  NOR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    has_character_flag = tsk_duel_death
    OR = {
      has_character_flag = tsk_duel_wounded_major
      has_character_flag = tsk_duel_wounded_minor
    }
  }
  NOR = {
    has_character_flag = tsk_duel_draw
    has_character_flag = tsk_duel_lost
    has_character_flag = tsk_duel_death
  }
}

is_victorious_untouched_opponent_wounded = {
  NOR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    NOT = {
      has_character_flag = tsk_duel_death
    }
  }
  NOR = {
    has_character_flag = tsk_duel_draw
    has_character_flag = tsk_duel_lost
    has_character_flag = tsk_duel_death
  }
}

is_draw_untouched_opponent_untouched = {
  has_character_flag = tsk_duel_draw
  NOR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    NOR = {
      has_character_flag = tsk_duel_wounded_major
      has_character_flag = tsk_duel_wounded_minor
      has_character_flag = tsk_duel_death
    }
  }
}

is_draw_untouched_opponent_wounded = {
  has_character_flag = tsk_duel_draw
  NOR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    OR = {
      has_character_flag = tsk_duel_wounded_major
      has_character_flag = tsk_duel_wounded_minor
    }
    NOT = { has_character_flag = tsk_duel_death }
  }
}

is_draw_wounded_opponent_untouched = {
  has_character_flag = tsk_duel_draw
  OR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    NOR = {
      has_character_flag = tsk_duel_wounded_major
      has_character_flag = tsk_duel_wounded_minor
    }
    NOT = { has_character_flag = tsk_duel_death }
  }
}

is_draw_wounded_opponent_wounded = {
  has_character_flag = tsk_duel_draw
  OR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    OR = {
      has_character_flag = tsk_duel_wounded_major
      has_character_flag = tsk_duel_wounded_minor
    }
    NOT = { has_character_flag = tsk_duel_death }
  }
}

is_draw_untouched_opponent_dead = {
  has_character_flag = tsk_duel_draw
  NOR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    has_character_flag = tsk_duel_death
  }
}

is_draw_wounded_opponent_dead = {
  has_character_flag = tsk_duel_draw
  OR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    has_character_flag = tsk_duel_death
  }
}

is_defeat_wounded_opponent_untouched = {
  has_character_flag = tsk_duel_lost
  OR = {
    has_character_flag = tsk_duel_wounded_major
    has_character_flag = tsk_duel_wounded_minor
  }
  FROM = {
    NOR = {
      has_character_flag = tsk_duel_wounded_major
      has_character_flag = tsk_duel_wounded_minor
    }
    NOT = { has_character_flag = tsk_duel_death }
  }
}

is_defeat_dead = {
  has_character_flag = tsk_duel_death
}

is_military_command_trigger = {
		government = military_command_government

}

can_wear_crown_trigger = {
	is_monarch_trigger = yes
}

is_monarch_trigger = { 
	higher_real_tier_than = DUKE 
	OR = {
			government = feudal_government
			government = stepstones_government
			government = muslim_government
			government = old_gods_government
			government = merchant_kingdom_government
			government = theocratic_kingdom_government
			government = storm_kingdom_government
			government = vale_government
			government = west_government
			government = reach_government
			government = ironborn_government
			government = winter_government
	}
}
		
