# Flags:
# betrayed_knighthood_the_seven
# society_join_block

knighthood_the_seven = {
    primary_attribute = martial
    is_religious = yes
    opinion_to_other_members = +10
    opinion_per_rank_above = +5
    opinion_to_perceived_members = +5
    
    sound = monastic_orders_interface
    
    society_ranks_gfx = knighthood_the_seven_ranks
    
    non_interference = {
        always = yes
    }
    active = {
        always = yes
    }
    indestructible = yes
    
    can_join_society = {
        hidden_trigger = {
            NAND = {
                ai = yes
                is_society_rank_full = { 
                    society = knighthood_the_seven
                    rank = 1
                }
            }
        }
        age = 16
        religion = the_seven
        NOT = { trait = excommunicated }
        custom_tooltip = {
            text = did_not_betray_society
            NOT = { has_character_flag = betrayed_knighthood_the_seven }
        }
        scaled_wealth = 0.25
        hidden_trigger = {
            NOT = { has_character_flag = society_join_block }
        }
        OR = {
            is_female = no
            AND = {
                trait = dueling_expert
                is_female = yes
            }
        }
    }
    
    show_society = {
        religion = the_seven
    }
    
    potential = {
        religion = the_seven
    }
    
    society_rank = {
        level = 1
        limit = 100 
        startup_limit = 10
        modifier = {
            monthly_character_prestige = 0.10
            martial = 1
            combat_rating = 1
        }
    }
    
    society_rank = {
        level = 2
        limit = 50
        startup_limit = 6
        modifier = {
            monthly_character_prestige = 0.15
            martial = 1
            combat_rating = 1
        }
        decisions = {
            request_knighthood
        }
    }
    
    society_rank = {
        level = 3
        limit = 20
        startup_limit = 3
        modifier = {
            monthly_character_prestige = 0.20
            martial = 2
            diplomacy = 1
            combat_rating = 2
        }
        decisions = {
            request_knighthood
        }
    }

    society_rank = {
        level = 4
        limit = 10
        startup_limit = 3
        modifier = {
            monthly_character_prestige = 0.50
            martial = 3
            diplomacy = 2
            combat_rating = 2
        }
        decisions = {
            request_knighthood
        }
    }
    
    society_rank = {
        level = 5
        limit = 1
        startup_limit = 1
        modifier = {
            monthly_character_prestige = 1.00
            martial = 3
            diplomacy = 2
            combat_rating = 3
        }
        decisions = {
            request_knighthood
        }
    }

    monthly_currency_gain = {
        name = currency_knighthood_the_seven
        
        per_attribute = {
            name = diplomacy
            value = 0.2
        }
        per_attribute = {
            name = learning
            value = 0.2
        }
        per_attribute = {
            name = stewardship
            value = 0.2
        }
        society_rank = {
            rank = 4
            value = 10
        }
        
        has_trait = {
            trait = diligent
            value = 1
        }
        has_trait = {
            trait = chaste
            value = 1
        }
        has_trait = {
            trait = temperate
            value = 1
        }
        has_trait = {
            trait = charitable
            value = 1
        }
        has_trait = {
            trait = kind
            value = 1
        }
        has_trait = {
            trait = patient
            value = 1
        }
        has_trait = {
            trait = humble
            value = 1
        }
        has_trait = {
            trait = honest
            value = 1
        }
    }

    member_score_per_attribute = 3
    member_score_per_rank = 100

    member_score = {
        value = 10
        
        modifier = {
            trait = celibate
            factor = 1.2
        }
        modifier = {
            trait = diligent
            factor = 1.2
        }
        modifier = {
            trait = chaste
            factor = 1.1
        }
        modifier = {
            trait = temperate
            factor = 1.1
        }
        modifier = {
            trait = charitable
            factor = 1.1
        }
        modifier = {
            trait = kind
            factor = 1.1
        }
        modifier = {
            trait = patient
            factor = 1.1
        }
        modifier = {
            trait = humble
            factor = 1.1
        }
        modifier = {
            trait = honest
            factor = 1.1
        }
    }
    
    startup_populate = {
        trigger = {
            ai = yes
            controls_religion = no
               religion = the_seven
            age = 16
            is_in_society = no
            NOR = {
                mercenary = yes
                holy_order = yes
            }
            NOT = { trait = excommunicated }
            has_secret_religion_trait_trigger = no
            OR = {
                trait = page
                trait = squire
                trait = knight
                martial = 16
            }
        }
    }
}

the_mystics = {
	primary_attribute = learning
	society_ranks_gfx = generic_ranks
	opinion_to_other_members = +10
	opinion_per_rank_above = +5
	sound = hermetic_society_interface
	non_interference = {
		always = yes
	}
	
	active = {
		has_dlc = "Mystics"
	}
	indestructible = yes
	
	can_join_society = {
		hidden_trigger = {
			NAND = {
				ai = yes
				is_society_rank_full = { 
					society = the_mystics
					rank = 1
				}
			}
			OR = {
				is_landed = yes
				is_patrician = yes
			}
		}
		learning = 10
		OR = {
			religion_group = the_seven_group
			religion_group = westerosi_pagan_group
			religion_group = drowned_god_group
			religion_group = eastern_group
			religion_group = valryian_group
			religion_group = eastern_pagan_group
			religion_group = other_group
			religion_group = far_east_group
		}
		NOR = {
			is_nomadic = yes
			is_tribal = yes
		}
		hidden_trigger = { mercenary = no }
		age = 16
		hidden_trigger = {
			NOT = { has_character_flag = society_join_block }
		}
	}

	show_society = {
		OR = {
			religion_group = the_seven_group
			religion_group = westerosi_pagan_group
			religion_group = drowned_god_group
			religion_group = eastern_group
			religion_group = valryian_group
			religion_group = eastern_pagan_group
			religion_group = other_group
			religion_group = far_east_group
			society_member_of = the_mystics
		}
	}
	
	potential = {
		#If something is added here, it could break apprenticeship. Create an event if they can get kicked out. title_hermetics_apprentice
	}
	
	society_rank = {
		level = 1
		limit = 200
		startup_limit = 10
		modifier = {
			church_opinion = -10
			#economy_techpoints = 0.05
		}
		decisions = {
			the_mystics_write_theory_paper # Enables you to write a theorem paper that, if approved, gives you society power
		}
	}
	
	society_rank = {
		level = 2
		limit = 100
		startup_limit = 6
		modifier = { 
			learning = 1
			church_opinion = -10
		}
		decisions = {
			the_mystics_perform_scrying # Enables you to perform a scrying and gain an omen
			brew_happiness_potion # Enables you to brew a potion
		}
	}
	
	society_rank = {
		level = 3
		limit = 50
		startup_limit = 4
		modifier = {
			learning = 2
			church_opinion = -10
		}
		decisions = {
			the_mystics_make_horoscope # Enables you to "predict" your children's future
		}
	}

	society_rank = {
		level = 4
		limit = 20
		startup_limit = 2
		modifier = { 
			learning = 3
			church_opinion = -10
		}
		decisions = {
			choose_mystic_art # Enables you to pick/change your lifestyle trait
			the_mystics_write_magnum_opus # Write an enciphered book of lore (artifact)
		}
	}
	
	plots = {
	}
	
	monthly_currency_gain = {
		name = currency_name_the_mystics
		
		per_attribute = {
    		name = learning
    		value = 0.5
    	}
		has_trait = {
			value = 2
			trait = diligent
		}
		has_trait = {
			value = 1
			trait = scholar
		}
		has_trait = {
			value = 1
			trait = mystic
		}
		has_trait = {
			value = 1
			trait = erudite
		}
		has_trait = {
			value = 1
			trait = stubborn
		}
		has_trait = {
			value = 1
			trait = patient
		}
		has_trait = {
			value = 1
			trait = genius
		}
		has_trait = {
			value = 1
			trait = quick
		}
		has_trait = {
			value = 1
			trait = shrewd
		}
		has_trait = {
			value = 1
			trait = just
		}
		society_rank = {
			rank = 4
			value = 10
		}
	}

	member_score_per_attribute = 3
	member_score_per_rank = 100

	member_score = {
		value = 10

		modifier = {
			factor = 2
			trait = diligent
		}
		modifier = {
			factor = 1.5
			trait = scholar
		}
		modifier = {
			factor = 1.5
			trait = mystic
		}
		modifier = {
			factor = 1.5
			trait = erudite
		}
		modifier = {
			factor = 1.5
			trait = stubborn
		}
		modifier = {
			factor = 1.5
			trait = patient
		}
		modifier = {
			factor = 1.5
			OR = {
				trait = genius
				trait = quick
				trait = shrewd
			}
		}
		modifier = {
			factor = 1.5
			trait = just
		}
	}
	
	startup_populate = {
	    trigger = {
			ai = yes
	    	controls_religion = no
			age = 16
			is_in_society = no
			is_dumb_trigger = no
			OR = {
				NOT = { is_priest = yes }
				OR = {
					trait = mystic
					trait = scholar
					trait = cynical
				}
			}
			OR = {
				AND = {
					is_landed = yes
					OR = { 
						learning = 14
						trait = scholar
						trait = erudite
						trait = genius
						trait = mystic
					}
				}
				AND = {
					learning = 18
					OR = {
						trait = scholar
						trait = erudite
						trait = genius
						trait = mystic
						learning = 20
					}
				}
			}
			OR = {
				any_religion_group = yes
			}
		}
	}
}
