# -*- ck2.decisions -*-
decisions = {

	emf_imperial_coronation = {
		only_independent = yes
		is_high_prio = yes

		potential = {
			NOT = { government = march_government }
			independent = yes
			tier = EMPEROR
			trait = uncrowned
			is_feudal = yes
			is_landed = yes
			has_horde_culture = no
			is_nomadic = no
			NOR = {
				emf_uses_valyrian_coronation = yes
				emf_uses_old_gods_hk_coronation = yes
				emf_uses_the_seven_hk_coronation = yes
				has_character_flag = planning_coronation
			}
			#emf_hiprio_decision_basic_potential = yes
		}
		allow = {
			war = no
			has_regent = no
			is_adult = yes
			scaled_wealth = 1.0
			piety = 25
			NOT = { trait = excommunicated }
			custom_tooltip = {
				text = HAS_BISHOP_WILLING_TO_CORONATE
				hidden_tooltip = {
					any_realm_lord = {
						capital_holding = { holding_type = temple }
						is_ruler = yes
						is_adult = yes
						religion = ROOT
						prisoner = no
						is_incapable = no
						NOT = { is_inaccessible_trigger = yes }
					}
				}
			}
			custom_tooltip = {
				text = IS_NOT_BUSY
				hidden_tooltip = {
					emf_can_disturb = yes
					NOT = { is_inaccessible_trigger = yes }
				}
			}
		}
		effect = {
			set_character_flag = planning_coronation
			scaled_wealth = -1.0
			character_event = { id = emf_coronation.1200 } # send invitations
			hidden_tooltip = {
				emf_do_not_disturb = yes
				narrative_event = { id = emf_coronation.1215 days = 30 } # coronation start
			}
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	emf_valyrian_coronation = {
		only_independent = yes
		is_high_prio = yes

		potential = {
			emf_uses_valyrian_emperor_coronation = yes
			NOT = { government = march_government }
			independent = yes
			tier = EMPEROR
			trait = uncrowned
			is_feudal = yes
			is_landed = yes
			has_horde_culture = no
			is_nomadic = no
			NOR = {
				emf_uses_old_gods_hk_coronation = yes
				emf_uses_the_seven_hk_coronation = yes
				has_character_flag = planning_coronation
			}
			#emf_hiprio_decision_basic_potential = yes
		}
		allow = {
			war = no
			has_regent = no
			is_adult = yes
			scaled_wealth = 1.0
			piety = 25
			NOT = { trait = excommunicated }
			custom_tooltip = {
				text = HAS_BISHOP_WILLING_TO_CORONATE
				hidden_tooltip = {
					any_realm_lord = {
						capital_holding = { holding_type = temple }
						is_ruler = yes
						is_adult = yes
						religion = ROOT
						prisoner = no
						is_incapable = no
						NOT = { is_inaccessible_trigger = yes }
					}
				}
			}
			custom_tooltip = {
				text = IS_NOT_BUSY
				hidden_tooltip = {
					emf_can_disturb = yes
					NOT = { is_inaccessible_trigger = yes }
				}
			}
		}
		effect = {
			set_character_flag = planning_coronation
			scaled_wealth = -1.0
			character_event = { id = emf_coronation.1200 } # send invitations
			hidden_tooltip = {
				emf_do_not_disturb = yes
				narrative_event = { id = emf_coronation.1483 days = 30 } # coronation start
			}
		}
		ai_will_do = {
			factor = 1
		}
	}

	emf_old_gods_coronation = {
		only_independent = yes
		is_high_prio = yes

		potential = {
			NOT = { government = march_government }
			independent = yes
			tier = EMPEROR
			trait = uncrowned
			is_feudal = yes
			is_landed = yes
			has_horde_culture = no
			is_nomadic = no
			emf_uses_old_gods_hk_coronation = yes
			NOR = {
				emf_uses_valyrian_coronation = yes
				emf_uses_the_seven_hk_coronation = yes
				has_character_flag = planning_coronation
			}
			#emf_hiprio_decision_basic_potential = yes
		}
		allow = {
			war = no
			has_regent = no
			is_adult = yes
			scaled_wealth = 1.0
			piety = 25
			NOT = { trait = excommunicated }
			custom_tooltip = {
				text = HAS_BISHOP_WILLING_TO_CORONATE
				hidden_tooltip = {
					any_realm_lord = {
						capital_holding = { holding_type = temple }
						is_ruler = yes
						is_adult = yes
						religion = ROOT
						prisoner = no
						is_incapable = no
						NOT = { is_inaccessible_trigger = yes }
					}
				}
			}
			custom_tooltip = {
				text = IS_NOT_BUSY
				hidden_tooltip = {
					emf_can_disturb = yes
					NOT = { is_inaccessible_trigger = yes }
				}
			}
		}
		effect = {
			set_character_flag = planning_coronation
			scaled_wealth = -1.0
			character_event = { id = emf_coronation.1200 } # send invitations
			hidden_tooltip = {
				emf_do_not_disturb = yes
				narrative_event = { id = emf_coronation.1483 days = 30 } # coronation start
			}
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	# emf_request_byzantine_coronation = {
		# only_independent = yes
		# is_high_prio = yes

		# potential = {
			# independent = yes
			# emf_uses_byzantine_coronation = yes
			# religion_head = {
				# OR = {
					# NOT = { has_character_flag = refused_to_coronate }
					# had_character_flag = { flag = refused_to_coronate days = 1095 }
				# }
			# }
			# NOR = {
				# trait = strong_basileus
				# trait = weak_basileus
				# has_character_flag = wants_coronation
				# has_character_flag = planning_coronation
			# }
			# #emf_hiprio_decision_basic_potential = yes
		# }
		# allow = {
			# war = no
			# has_regent = no
			# is_adult = yes
			# piety = 25
			# scaled_wealth = 1.0
		# }
		# effect = {
			# set_character_flag = wants_coronation
			# religion_head = {
				# character_event = { id = emf_coronation.1321 tooltip = WILL_CONSIDER_REQUEST }
			# }
		# }
		# ai_will_do = {
			# factor = 1
		# }
	# }

	emf_request_papal_coronation  = {
		only_independent = yes
		is_high_prio = yes

		potential = {
			NOT = { government = march_government }
			independent = yes
			emf_uses_the_seven_hk_coronation = yes
			NOR = {
				emf_uses_valyrian_coronation = yes
				emf_uses_old_gods_hk_coronation = yes
				trait = crowned_the_seven_high_king
				has_character_flag = wants_coronation
				has_character_flag = planning_coronation
			}
			#emf_hiprio_decision_basic_potential = yes
		}
		allow = {
			war = no
			has_regent = no
			is_adult = yes
			prestige = 1000
			scaled_wealth = 1.0
			piety = 200
			custom_tooltip = {
				text = POPE_WOULD_HEAR_REQUEST
				hidden_tooltip = {
					NOT = { trait = excommunicated }
					religion_head = {
						NOT = { has_opinion_modifier = { who = ROOT modifier = coronation_rejected } }
					}
				}
			}
		}
		effect = {
			set_character_flag = wants_coronation
			character_event = { id = emf_coronation.1475 tooltip = PLAN_FOR_CORONATION }
		}
		ai_will_do = {
			factor = 1
		}
	}

	emf_royal_coronation = {
		only_playable = yes
		is_high_prio = yes

		potential = {
			NOT = { government = march_government }
			is_playable = yes
			real_tier = KING
			trait = uncrowned
			is_feudal = yes
			is_landed = yes
			has_horde_culture = no
			is_nomadic = no
			primary_title = { is_vice_royalty = no }
			NOT = { has_character_flag = planning_coronation }
			#emf_imperial_government = no
			#emf_hiprio_decision_basic_potential = yes
		}
		allow = {
			war = no
			has_regent = no
			is_adult = yes
			scaled_wealth = 1.0
			piety = 25
			NOT = { trait = excommunicated }
			custom_tooltip = {
				text = HAS_BISHOP_WILLING_TO_CORONATE
				hidden_tooltip = {
					any_realm_lord = {
						capital_holding = { holding_type = temple }
						is_ruler = yes
						religion = ROOT
						is_adult = yes
						prisoner = no
						is_incapable = no
						NOT = { is_inaccessible_trigger = yes }
					}
				}
			}
			custom_tooltip = {
				text = IS_NOT_BUSY
				hidden_tooltip = {
					emf_can_disturb = yes
					NOT = { is_inaccessible_trigger = yes }
				}
			}
		}
		effect = {
			set_character_flag = planning_coronation
			scaled_wealth = -1.0
			character_event = { id = emf_coronation.1200 } # send invitations
			hidden_tooltip = {
				emf_do_not_disturb = yes
				narrative_event = { id = emf_coronation.1215 days = 30 } # coronation start
			}
		}
		ai_will_do = {
			factor = 1
		}
	}
}

