namespace = maintenance

#maintenance.31	#Auto adding honourary titles

#Auto adding honourary titles
character_event = {
	id = maintenance.31
	
	is_triggered_only = yes
	hide_window = yes
	ai = no
	has_character_flag = auto_assign_minor_titles 
	
	trigger = { }
	
	immediate = {
		##Commanders##
		if = {
			limit = {
				NOT = {
					any_courtier_or_vassal = {
						count = 2
						liege = { character = ROOT }
						has_minor_title = title_commander
					}
				}
			}
			random_courtier_or_vassal = {
				limit = {
					martial = 8
					can_hold_title = title_commander
					ai = yes
					liege = { character = ROOT }
					NOT = { has_minor_title = title_commander }
					NOT = { has_job_title = job_marshal }				
					NOT = {
						ROOT = {
							any_courtier_or_vassal = {
								martial = 8
								can_hold_title = title_commander
								attribute_diff = { character = PREVPREV attribute = martial value = 1 }
								ai = yes
								liege = { character = ROOT }
								NOT = { has_minor_title = title_commander }
								NOT = { has_job_title = job_marshal }		
							}
						}
					}
				}
				give_minor_title = title_commander
			}
		}
		if = {
			limit = {
				NOT = {
					any_courtier_or_vassal = {
						count = 2
						liege = { character = ROOT }
						has_minor_title = title_commander
					}
				}
			}
			random_courtier_or_vassal = {
				limit = {
					martial = 8
					can_hold_title = title_commander
					ai = yes
					liege = { character = ROOT }
					NOT = { has_minor_title = title_commander }
					NOT = { has_job_title = job_marshal }				
					NOT = {
						ROOT = {
							any_courtier_or_vassal = {
								martial = 8
								can_hold_title = title_commander
								attribute_diff = { character = PREVPREV attribute = martial value = 1 }
								ai = yes
								liege = { character = ROOT }
								NOT = { has_minor_title = title_commander }
								NOT = { has_job_title = job_marshal }		
							}
						}
					}
				}
				give_minor_title = title_commander
			}
		}
		if = {
			limit = { higher_tier_than = COUNT }
			if = {
				limit = {
					NOT = {
						any_courtier_or_vassal = {
							count = 4
							liege = { character = ROOT }
							has_minor_title = title_commander
						}
					}
				}
				random_courtier_or_vassal = {
					limit = {
						martial = 8
						can_hold_title = title_commander
						ai = yes
						liege = { character = ROOT }
						NOT = { has_minor_title = title_commander }
						NOT = { has_job_title = job_marshal }				
						NOT = {
							ROOT = {
								any_courtier_or_vassal = {
									martial = 8
									can_hold_title = title_commander
									attribute_diff = { character = PREVPREV attribute = martial value = 1 }
									ai = yes
									liege = { character = ROOT }
									NOT = { has_minor_title = title_commander }
									NOT = { has_job_title = job_marshal }		
								}
							}
						}
					}
					give_minor_title = title_commander
				}
			}
			if = {
				limit = {
					NOT = {
						any_courtier_or_vassal = {
							count = 4
							liege = { character = ROOT }
							has_minor_title = title_commander
						}
					}
				}
				random_courtier_or_vassal = {
					limit = {
						martial = 8
						can_hold_title = title_commander
						ai = yes
						liege = { character = ROOT }
						NOT = { has_minor_title = title_commander }
						NOT = { has_job_title = job_marshal }				
						NOT = {
							ROOT = {
								any_courtier_or_vassal = {
									martial = 8
									can_hold_title = title_commander
									attribute_diff = { character = PREVPREV attribute = martial value = 1 }
									ai = yes
									liege = { character = ROOT }
									NOT = { has_minor_title = title_commander }
									NOT = { has_job_title = job_marshal }		
								}
							}
						}
					}
					give_minor_title = title_commander
				}
			}
		}	
		if = {
			limit = { higher_tier_than = DUKE }
			if = {
				limit = {
					NOT = {
						any_courtier_or_vassal = {
							count = 6
							liege = { character = ROOT }
							has_minor_title = title_commander
						}
					}
				}
				random_courtier_or_vassal = {
					limit = {
						martial = 8
						can_hold_title = title_commander
						ai = yes
						liege = { character = ROOT }
						NOT = { has_minor_title = title_commander }
						NOT = { has_job_title = job_marshal }				
						NOT = {
							ROOT = {
								any_courtier_or_vassal = {
									martial = 8
									can_hold_title = title_commander
									attribute_diff = { character = PREVPREV attribute = martial value = 1 }
									ai = yes
									liege = { character = ROOT }
									NOT = { has_minor_title = title_commander }
									NOT = { has_job_title = job_marshal }		
								}
							}
						}
					}
					give_minor_title = title_commander
				}
			}
			if = {
				limit = {
					NOT = {
						any_courtier_or_vassal = {
							count = 6
							liege = { character = ROOT }
							has_minor_title = title_commander
						}
					}
				}
				random_courtier_or_vassal = {
					limit = {
						martial = 8
						can_hold_title = title_commander
						ai = yes
						liege = { character = ROOT }
						NOT = { has_minor_title = title_commander }
						NOT = { has_job_title = job_marshal }				
						NOT = {
							ROOT = {
								any_courtier_or_vassal = {
									martial = 8
									can_hold_title = title_commander
									attribute_diff = { character = PREVPREV attribute = martial value = 1 }
									ai = yes
									liege = { character = ROOT }
									NOT = { has_minor_title = title_commander }
									NOT = { has_job_title = job_marshal }		
								}
							}
						}
					}
					give_minor_title = title_commander
				}
			}
		}
		if = {
			limit = { tier = EMPEROR }
			if = {
				limit = {
					NOT = {
						any_courtier_or_vassal = {
							count = 8
							liege = { character = ROOT }
							has_minor_title = title_commander
						}
					}
				}
				random_courtier_or_vassal = {
					limit = {
						martial = 8
						can_hold_title = title_commander
						ai = yes
						liege = { character = ROOT }
						NOT = { has_minor_title = title_commander }
						NOT = { has_job_title = job_marshal }				
						NOT = {
							ROOT = {
								any_courtier_or_vassal = {
									martial = 8
									can_hold_title = title_commander
									attribute_diff = { character = PREVPREV attribute = martial value = 1 }
									ai = yes
									liege = { character = ROOT }
									NOT = { has_minor_title = title_commander }
									NOT = { has_job_title = job_marshal }		
								}
							}
						}
					}
					give_minor_title = title_commander
				}
			}
			if = {
				limit = {
					NOT = {
						any_courtier_or_vassal = {
							count = 8
							liege = { character = ROOT }
							has_minor_title = title_commander
						}
					}
				}
				random_courtier_or_vassal = {
					limit = {
						martial = 8
						can_hold_title = title_commander
						ai = yes
						liege = { character = ROOT }
						NOT = { has_minor_title = title_commander }
						NOT = { has_job_title = job_marshal }				
						NOT = {
							ROOT = {
								any_courtier_or_vassal = {
									martial = 8
									can_hold_title = title_commander
									attribute_diff = { character = PREVPREV attribute = martial value = 1 }
									ai = yes
									liege = { character = ROOT }
									NOT = { has_minor_title = title_commander }
									NOT = { has_job_title = job_marshal }		
								}
							}
						}
					}
					give_minor_title = title_commander
				}
			}
		}
		##Other Titles##
		if = { #Westerosi
			limit = {
				is_republic = no
				is_theocracy = no		
				NOT = { trait = black_brother }
				OR = {
					culture_group = andal
					culture_group = dornish
					culture_group = first_men
					AND = {
						culture_group = valyrian
						capital_scope = { region = world_westeros }
					}
				}
			}
			if = {
				limit = {
					higher_tier_than = DUKE
					NOT = { has_assigned_minor_title = title_keeper_of_swans }
				}
				random_vassal = {
					limit = {
						opinion = { who = ROOT value = -50 }
						NOT = { opinion = { who = ROOT value = 0 } }
						OR = {
							NOT = { tier = BARON }
							ROOT = { tier = COUNT }
						}
						can_hold_title = title_keeper_of_swans
					}
					give_minor_title = title_keeper_of_swans
				}
			}
			if = {
				limit = {
					NOT = { has_assigned_minor_title = title_master_of_the_hunt }
				}
				random_vassal = {
					limit = {
						opinion = { who = ROOT value = -50 }
						NOT = { opinion = { who = ROOT value = 0 } }
						OR = {
							NOT = { tier = BARON }
							ROOT = { tier = COUNT }
						}
						can_hold_title = title_master_of_the_hunt
					}
					give_minor_title = title_master_of_the_hunt
				}
			}
			if = {
				limit = {
					NOT = { has_assigned_minor_title = title_high_almoner }
				}
				random_vassal = {
					limit = {
						opinion = { who = ROOT value = -50 }
						NOT = { opinion = { who = ROOT value = 0 } }
						OR = {
							NOT = { tier = BARON }
							ROOT = { tier = COUNT }
						}
						can_hold_title = title_high_almoner	
					}
					give_minor_title = title_high_almoner
				}
			}			
		}
		if = { #Master of the Horse
			limit = {
				is_republic = no
				is_theocracy = no	
				NOT = { trait = black_brother }
				OR = {
					culture_group = andal
					culture_group = dornish
					culture_group = first_men
					AND = {
						culture_group = valyrian
						capital_scope = { region = world_westeros }
					}
					culture = dothraki
				}
				NOT = { has_assigned_minor_title = title_master_of_the_horse }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_master_of_the_horse
				}
				give_minor_title = title_master_of_the_horse
			}
		}
		if = { #Cupbearer
			limit = {
				is_republic = no
				is_theocracy = no
				NOT = { trait = black_brother }
				OR = {
					culture_group = andal
					culture_group = dornish
					culture_group = first_men
					AND = {
						culture_group = valyrian
						capital_scope = { region = world_westeros }
					}
				}
				NOT = { has_assigned_minor_title = title_cupbearer }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_cupbearer
				}
				give_minor_title = title_cupbearer
			}
		}
		if = { #Senschal
			limit = {
				higher_tier_than = DUKE
				NOT = { trait = black_brother }
				OR = {
					culture_group = essos_group
					culture = ghiscari
					AND = {
						culture_group = valyrian
						NOT = { capital_scope = { region = world_westeros } }
					}	
					culture = dothraki
				}
				is_nomadic = no
				is_tribal = no
				NOT = { has_assigned_minor_title = title_seneschal }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_seneschal
				}
				give_minor_title = title_seneschal
			}
		}
		if = { #Paramount Knight
			limit = {
				higher_tier_than = DUKE
				independent = yes
				religion = the_seven
				NOT = { tier = EMPEROR }
				NOT = { has_assigned_minor_title = title_paramount_knight }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_paramount_knight
				}
				give_minor_title = title_paramount_knight
			}
		}
		if = { #Food taster
			limit = {
				OR = {
					is_patrician = yes
					higher_tier_than = DUKE
				}	
				NOT = { trait = black_brother }
				OR = {
					culture_group = essos_group
					AND = {
						culture_group = valyrian
						NOT = { capital_scope = { region = world_westeros } }
					}
					culture = dothraki
				}
				is_nomadic = no
				is_tribal = no
				NOT = { has_assigned_minor_title = title_food_taster }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_food_taster
				}
				give_minor_title = title_food_taster
			}
		}	
		if = { #Court Musician
			limit = {
				NOT = { trait = black_brother }
				is_merchant_republic = no
				OR = {
					culture_group = essos_group
					culture = ghiscari
					AND = {
						culture_group = valyrian
						NOT = { capital_scope = { region = world_westeros } }
					}
				}
				NOT = { has_assigned_minor_title = title_court_musician }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_court_musician
				}
				give_minor_title = title_court_musician
			}
		}
		if = { #Court poet
			limit = {
				NOT = { trait = black_brother }
				OR = {
					culture_group = essos_group
					culture = ghiscari
					AND = {
						culture_group = valyrian
						NOT = { capital_scope = { region = world_westeros } }
					}
				}
				NOT = { has_assigned_minor_title = title_court_poet }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_court_poet
				}
				give_minor_title = title_court_poet
			}
		}	
		if = { #Chief architect
			limit = {
				NOT = { trait = black_brother }
				is_merchant_republic = no
				OR = {
					culture_group = essos_group
					culture = ghiscari
					AND = {
						culture_group = valyrian
						NOT = { capital_scope = { region = world_westeros } }
					}
				}
				NOT = { has_assigned_minor_title = title_chief_architect }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_chief_architect
				}
				give_minor_title = title_chief_architect
			}
		}	
		if = { #Republics
			limit = {
				is_merchant_republic = yes
			}
			if = {
				limit = { NOT = { has_assigned_minor_title = { title = title_state_inquisitor count = 3 } } }
				random_vassal = {
					limit = {
						opinion = { who = ROOT value = -50 }
						NOT = { opinion = { who = ROOT value = 0 } }
						OR = {
							NOT = { tier = BARON }
							ROOT = { tier = COUNT }
						}
						can_hold_title = title_state_inquisitor
					}
					give_minor_title = title_state_inquisitor
				}
				if = {
					limit = { NOT = { has_assigned_minor_title = { title = title_state_inquisitor count = 3 } } }
					random_vassal = {
						limit = {
							opinion = { who = ROOT value = -50 }
							NOT = { opinion = { who = ROOT value = 0 } }
							OR = {
								NOT = { tier = BARON }
								ROOT = { tier = COUNT }
							}
							can_hold_title = title_state_inquisitor
						}
						give_minor_title = title_state_inquisitor
					}
					if = {
						limit = { NOT = { has_assigned_minor_title = { title = title_state_inquisitor count = 3 } } }
						random_vassal = {
							limit = {
								opinion = { who = ROOT value = -50 }
								NOT = { opinion = { who = ROOT value = 0 } }
								OR = {
									NOT = { tier = BARON }
									ROOT = { tier = COUNT }
								}
								can_hold_title = title_state_inquisitor
							}
							give_minor_title = title_state_inquisitor
						}
					}
				}			
			}
			if = {
				limit = {
					NOT = { has_dlc = "Zeus" }
					NOT = { has_assigned_minor_title = title_high_admiral }
				}
				random_vassal = {
					limit = {
						opinion = { who = ROOT value = -50 }
						NOT = { opinion = { who = ROOT value = 0 } }
						OR = {
							NOT = { tier = BARON }
							ROOT = { tier = COUNT }
						}
						can_hold_title = title_high_admiral
					}
					give_minor_title = title_high_admiral
				}
			}
			if = {
				limit = {
					NOT = { has_assigned_minor_title = title_high_judge }
				}
				random_vassal = {
					limit = {
						opinion = { who = ROOT value = -50 }
						NOT = { opinion = { who = ROOT value = 0 } }
						OR = {
							NOT = { tier = BARON }
							ROOT = { tier = COUNT }
						}
						can_hold_title = title_high_judge
					}
					give_minor_title = title_high_judge
				}
			}
		}
		if = { #Lawspeaker
			limit = {
				is_republic = no
				is_theocracy = no	
				NOT = { trait = black_brother }
				culture = dothraki
				NOT = { has_assigned_minor_title = title_lawspeaker }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_lawspeaker
				}
				give_minor_title = title_lawspeaker
			}
		}
		if = { #Champion
			limit = {
				is_republic = no
				is_theocracy = no	
				NOT = { trait = black_brother }
				OR = {
					culture_group = free_folk
					culture_group = iron_islander
					culture = dothraki
				}
				NOT = { has_assigned_minor_title = title_champion }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_champion
				}
				give_minor_title = title_champion
			}
		}
		if = { #Master of the Blade
			limit = {
				is_republic = no
				is_theocracy = no	
				NOT = { trait = black_brother }
				OR = {
					culture_group = free_folk
					culture_group = iron_islander
					culture = dothraki
				}
				NOT = { has_assigned_minor_title = title_master_of_the_blade }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_master_of_the_blade
				}
				give_minor_title = title_master_of_the_blade
			}
		}
		if = { #Master of the Bow
			limit = {
				is_republic = no
				is_theocracy = no	
				NOT = { trait = black_brother }
				OR = {
					culture_group = free_folk
					culture_group = iron_islander
					culture = dothraki
				}
				NOT = { has_assigned_minor_title = title_master_of_the_bow }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_master_of_the_bow
				}
				give_minor_title = title_master_of_the_bow
			}
		}
		if = { #Venerable elder
			limit = {
				is_republic = no
				is_theocracy = no	
				NOT = { trait = black_brother }
				OR = {
					culture_group = free_folk
					culture = dothraki
				}
				NOT = { has_assigned_minor_title = title_venerable_elder }
			}
			random_vassal = {
				limit = {
					opinion = { who = ROOT value = -50 }
					NOT = { opinion = { who = ROOT value = 0 } }
					OR = {
						NOT = { tier = BARON }
						ROOT = { tier = COUNT }
					}
					can_hold_title = title_venerable_elder
				}
				give_minor_title = title_venerable_elder
			}
		}
	}
	
	option = {
		name = OK
	}
}